#!/usr/bin/env python3

import sys
import os

# Ensure we're in the project directory
project_dir = os.path.abspath(os.path.dirname(__file__))
sys.path.insert(0, project_dir)

from src.exploitation.payloads.webshells import get_available_shells, generate_shell

def main():
    """Test exploitation tools"""
    print("Testing webshell generator...")
    available_shells = get_available_shells()
    
    print("\nAvailable Webshells:")
    for shell_type, variants in available_shells.items():
        print(f"\n{shell_type.upper()}:")
        for variant, description in variants.items():
            print(f"  {variant}: {description}")
    
    # Try generating a webshell
    shell_type = "php"
    variant = "mini"
    print(f"\nGenerating {shell_type} webshell, variant: {variant}")
    shell_code = generate_shell(shell_type, variant)
    
    print("\nWebshell Code:")
    print("=" * 60)
    print(shell_code)
    print("=" * 60)

if __name__ == "__main__":
    main()