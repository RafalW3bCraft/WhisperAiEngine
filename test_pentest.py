#!/usr/bin/env python3
"""
Test script for G3r4ki penetration testing module
"""

import sys
import os
from src.pentest.shells import reverse_shells

def test_shells():
    """Test the reverse shells library"""
    print("Testing G3r4ki Reverse Shells Library")
    print("=" * 50)
    
    # Test shell type listing
    print("\nAvailable shell types:")
    shell_types = reverse_shells.list_shell_types()
    for shell_type in shell_types:
        print(f"  - {shell_type}")
    
    # Test variants for bash shells
    print("\nBash shell variants:")
    bash_variants = reverse_shells.list_shell_variants("bash")
    for variant in bash_variants:
        print(f"  - {variant}")
    
    # Generate a bash shell
    print("\nGenerated bash shell (basic):")
    bash_shell = reverse_shells.get_bash_shell("basic")
    print(bash_shell)
    
    # Generate a Python shell
    print("\nGenerated Python shell (python3):")
    python_shell = reverse_shells.get_python_shell("python3")
    print(python_shell)
    
    # Generate all shells
    print("\nAll available shells:")
    shells = reverse_shells.get_all_shells()
    
    for shell_type, variants in shells.items():
        print(f"\n[{shell_type}]")
        for variant, command in variants.items():
            print(f"  * {variant}: {command[:50]}...")

def main():
    """Main function"""
    test_shells()

if __name__ == "__main__":
    main()